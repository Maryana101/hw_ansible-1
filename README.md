# Домашнее задание к занятию "Ansible. Часть 1" - Варфоломеева Марьяна

### Задание 1

Какие преимущества даёт подход IAC?

### Ответ

  * Нет необходимости в ручной настройке
  * Скорость — настройка («поднятие») инфраструктуры занимает
  заметно меньше времени
  * Воспроизводимость — поднимаемая инфраструктура всегда
  идентична
  * Масштабируемость — один инженер может с помощью
  одного и того же кода настраивать и управлять огромным
  количеством машин

---

### Задание 2

Выполните действия и приложите скриншоты действий.

  1. Установите Ansible.
  1. Настройте управляемые виртуальные машины, не меньше двух.
  1. Создайте файл inventory с созданными вами ВМ.
  1. Проверьте доступность хостов с помощью модуля ping.


### Ответ

1. Установка Ansible (ОС Fedora):

 ```>> dnf install ansible ```

![](./img/1_ansible_intall.png)

2. Виртуальные машины настроены через Vagrantfile, предоставленный к лекции.

```>> vagrant up ```
   
![](./img/2_vagrant_up.png)
![](./img/3_vm_status.png)

в ходе установки виртуальные машины получили следующие ip-адреса (bridge):
![](./img/4_ip-addr.png)

3. Настроен inventory  файл с указанием полученных ip-адресов в группе новой группе "my":

![](./img/5_inventory.png)

4. Проверка доступности ВМ через пинг:

![](./img/6_ping.png)

---

### Задание 3

Какая разница между параметрами forks и serial?

### Ответ

Параметр **forks** настраивается в ansible.cfg (по умолчанию закомментирован и установлен=5).
![](./img/11_forks.png)
Также можно его указать при выполнении плейбука с ключом -f:
```ansible-playbook -f 10 myplaybook.yml```

Этот параметр указывает кол-во хостов, которые Ansible обрабатывает одновременно. 
Например, имеется 2 узла, и forks = 2
При запуске плейбука с 2 задачами: 
 * первая задача будет выполнена параллельно на 2 узлах.
 * вторая задача будет также выполнена  параллельно на 2 узлах.

Если каждая задача выполняется 5 сек, то общее время выполнения плейбука = 10 сек (вместо 20 сек при последовательном выполнении)

Параметр **serial** 

Определяет количество хостов для выполнения в каждой задаче за один запуск.
Параметр можно настроить в плейбуке:

![](./img/serial.png)

При запуске плейбука со скриншота выше для 6 хостов задачи будут выполнены пачками: 
 * сначала последовательно выполнятся задачи (1 и 2) для первых трех серверов
 * затем также для следующих трех серверов

![](./img/serial_ex.png)
### Задание 4

В этом задании вы будете работать с Ad-hoc коммандами.

Выполните действия и приложите скриншоты запуска команд.

   1. Установите на управляемых хостах любой пакет, которого нет. 
   1. Проверьте статус любого, присутствующего на управляемой машине, сервиса.
   1. Создайте файл с содержимым «I like Linux» по пути /tmp/netology.txt.

### Ответ
1. Установка mc через модуль yum:
```>> ansible my -m yum -a "name=mc state=latest" -b```
![](./img/7_install_mc.png)

1. Проверка статуса сервиса через модуль service:
```>> ansible my -m service -a 'name=sshd' ```
![](./img/8_serv_status.png)

1. Добавление файла через модуль copy:

```>> ansible my -m copy -a "content='I like Linux' dest=/mnt/netology.txt" -b ```

![](./img/10_add_file.png)
